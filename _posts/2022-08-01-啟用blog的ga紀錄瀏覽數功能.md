---
title: 005_啟用 Blog 的 GA 紀錄瀏覽數功能
date: '2022-08-01 17:04:06 +0800'
categories: [Blog]
tags: [google-analytics,gcp,github-pages]     # TAG names should always be lowercase
author: owen
mermaid: true
math: true
---

> 因為 GA 版本問題，這種作法只能用到 2023 的 7 月份
{: .prompt-warning }

# 目標
既然都自己建 blog 了，當然也要關注一下有沒有人來瀏覽看看，所以就直接參考官網提供的方式，啟用 page views 功能來查看文章瀏覽數。

# 參考資料
- <https://chirpy.cotes.page/posts/enable-google-pv/>

# 設定流程總覽
1. 透過 <https://analytics.google.com/> 設定 GA 帳號和 property
2. 前往 GCP 介面設定 Google App Engine
3. 設定 GA superProxy (透過 google cloud shell)
4. 設定 Blog 把顯示文章瀏覽數功能開啟

# 設定流程重點截圖

> 到 <https://analytics.google.com> 點開始測量，填入帳號名稱(自己隨便填)，然後帳戶資料共用設定採預設就好
![](/commons/image/20220801/000_page-views.png)

> 設定資源名稱()
![](/commons/image/20220801/001_page-views.png)

> 其他資訊(這部分應該可以隨意填)
![](/commons/image/20220801/002_page-views.png)

> 設定 GA 資料來源
![](/commons/image/20220801/003_page-views.png)
![](/commons/image/20220801/004_page-views.png)

> 複製 Measurement ID(評估ID) 到自己 repo 的 _config.yml，設定 google_analytics 的 id 字段，然後 git push 一次
![](/commons/image/20220801/005_page-views.png)
![](/commons/image/20220801/006_page-views.png)
![](/commons/image/20220801/007_page-views.png)

> 大概 push 後過一段時間(官網是說 5 min)，可以在 GA 的 Dashboard 上面看到部落格的 traffic 資訊
{: .prompt-tip }

> 到 GCP <https://console.cloud.google.com/appengine> 建立 Google App Engine (這邊官網有說費用在 free-tier 之下，但僅限用於官網此篇設定)。這邊如果沒啟用 billing 的 GCP Account 要先啟用


> 到 API & Services 的頁面啟用 Google Analytics APIs 的功能


> 在左邊導覽列點選 Oauth consent screen 選擇 external (因為 blog 是外部 public 的)，剩下的把必填的資料填一填，例如 app name 和 email 等等，其它的先不用填。


> 左邊導覽列點 Credentials 創建一個 OAuth Client IDs 的 credentials，然後把 redirect URIs 設定成 https://<project-id>.<region>.r.appspot.com/admin/auth 的格式，會得到一組 client ID 和 client secret，要記下來


> 在 Cloud shell 上 clone GA 設定 app engine 的專案，然後移除 src/app.yaml 的最上面兩行，並編輯 src/config.py 檔案填妥相關資料(剛剛的 client id 和 client secret 會在這邊用到)


# 其它故障排除

> 可能會遇到 gcr 沒有啟用的問題
![](/commons/image/20220801/999_page-views.png)
![](/commons/image/20220801/998_page-views.png)